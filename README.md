# Tajine
## Purpose

This script provides post-processing of acoustic measurements performed with the sine sweep technique.
The traditional workflows, such as the use of a DAW (like Adobe Audition 3.0) alongside acoustic elaboration plugins (like Aurora) are cumersome and require many manual steps which highly prone to user errors.

The main purpose of this script is to embrace all the manual step leaving to the user just few manual visual or auditory checks that simplify the procedure but leaving control to the operator.

## Features

- Support and process multiple transducers file (monoaural omni mic, binaural 2-channel dummy head, 3D A-Format mic)
- It extracts and analyse Impulse Responses based on the capturing transducer 
- It works on both Windows and MacOS 

## Software required
- Matlab 2025a (previous versions have not been tested)
- [Sennheiser AMBEO A-B format converter plugin](https://www.sennheiser.com/en-lt/catalog/products/microphones/ambeo-vr-mic/ambeo-vr-mic-507195#Downloads) (Au version for MacOs and VST3 version for Windows)

## Workflow

- **Input**: Multichannel audio data acquired through an audio interface from multiple microphones (transducers), inverse sweep.

- **Deconvolution**: Each transducer channel is deconvolved with the inverse of the excitation sweep to obtain the corresponding Impulse Response (IR).

- **Computation**: Each tranducers set of signals is processed by AcouPar to obtain specific acoustic parameters.

- **Output**: For each transducer, a dedicated audio file is created, containing the IRs, as well as a set of text files containing the acoustic parameters and a wrap-up spreadsheet file

## Output

- A set of WAV files each file includes all elaborated IR  belonging to a single transducer (monoaural omnidirectional, binaural dummyhead, ambeo VR mic).
- A set of txt files containig the acoustic parameters belonging to a single transducer
- A wrap-up excel with containing the parameters organized in different tables, one per each transducers

## How-to
1. Specify a name to identify the measurement site (used to create the output folder) `siteName` (e.g.: *zagreb-national-thater*)
2. Specify the name of the measurement point related to the audio file in `probeId` (e.g.: *p1-gallery-bis*)
3. Specify the path of the file to elaborate `inputFile` 
4. Specify the path of the Inverse Sweep file `invSweepFile`
5. Check and modify pre-delay and IR trimming length in `preDly`and `irTrimLen`. 
> **Note:** These values can be changed also in a second time after the script has been launched once, and the Impulse Response length has been verified; the script can be launched again to apply the new values
6. Launch the script

### Manual checks
- The user shall perform a visual check of the input file audio plot in Figure 1 (sweep recording)
- The user shall perform a visual check of the found Impulse Response and its trimmed version (Figure 2)

## Print & Images

A command line typical output generated by Tajine can be found [here](docs/cmd_output.md).

<img src="docs/imgs/raw-recording.png" width="800" height="450">
<img src="docs/imgs/IR-deconvolution.png" width="800" height="450">
<img src="docs/imgs/B-Format-conversion.png" width="800" height="450">
<img src="docs/imgs/Output-tree.png" width="150" height="200">
<img src="docs/imgs/T30.png" width="400" height="350">